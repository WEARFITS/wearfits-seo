<!-- Shared Analytics Component -->
<!-- Include this in the <head> of every page -->

<!-- Google Analytics 4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  
  // Shared GA4 property with domain dimension
  gtag('config', 'G-XXXXXXXXXX', {
    'custom_map': {'dimension1': 'domain'},
    'domain': window.location.hostname
  });
  
  // Track CTA clicks
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('a[href*="wearfits.com"]').forEach(function(link) {
      link.addEventListener('click', function() {
        gtag('event', 'cta_click', {
          'event_category': 'conversion',
          'event_label': link.textContent,
          'source_domain': window.location.hostname,
          'destination': link.href
        });
      });
    });
  });
</script>

<!-- Google Search Console Verification -->
<!-- Each domain needs its own meta tag (added per-domain in index.html) -->

<!-- Bing Webmaster Tools Verification -->
<!-- Each domain needs its own meta tag (added per-domain in index.html) -->

<!-- Performance Monitoring -->
<script>
  // Web Vitals tracking
  (function() {
    if ('PerformanceObserver' in window) {
      // Track Largest Contentful Paint (LCP)
      new PerformanceObserver((list) => {
        for (const entry of list.getEntries()) {
          gtag('event', 'web_vitals', {
            'metric': 'LCP',
            'value': Math.round(entry.renderTime || entry.loadTime),
            'domain': window.location.hostname
          });
        }
      }).observe({type: 'largest-contentful-paint', buffered: true});

      // Track First Input Delay (FID)
      new PerformanceObserver((list) => {
        for (const entry of list.getEntries()) {
          gtag('event', 'web_vitals', {
            'metric': 'FID',
            'value': Math.round(entry.processingStart - entry.startTime),
            'domain': window.location.hostname
          });
        }
      }).observe({type: 'first-input', buffered: true});

      // Track Cumulative Layout Shift (CLS)
      let clsValue = 0;
      new PerformanceObserver((list) => {
        for (const entry of list.getEntries()) {
          if (!entry.hadRecentInput) {
            clsValue += entry.value;
          }
        }
      }).observe({type: 'layout-shift', buffered: true});

      // Send CLS on page unload
      window.addEventListener('beforeunload', () => {
        gtag('event', 'web_vitals', {
          'metric': 'CLS',
          'value': Math.round(clsValue * 1000),
          'domain': window.location.hostname
        });
      });
    }
  })();
</script>
